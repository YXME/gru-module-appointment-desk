<#include "manageappointmentdesk_tabs.html" />
<@box>
	<@boxHeader title='#i18n{appointment-desk.manage_appointmentdesk.title}' boxTools=true>
		<@tform class='form-inline pull-right' name='manage_appointmentdesk' action='jsp/admin/plugins/appointment/modules/desk/ManageAppointmentDesks.jsp'>
			<@button type='submit' name='view_createAppointmentDesk' buttonIcon='plus' title='#i18n{appointment-desk.manage_appointmentdesks.buttonAdd}' />
		</@tform>
	</@boxHeader>
	<@boxBody>       
    <@messages infos=infos />
    <@paginationAdmin paginator=paginator combo=1 />
<@row>
<@tform class='' name='manage_appointmentdesk' action='jsp/admin/plugins/appointment/modules/desk/ManageAppointmentDesks.jsp'>
<input type="hidden" name="id_form" value="${idForm!}">
<@formGroup labelFor='day' labelKey=''>

	<@inputGroup>

		<@input type='text' name='day' id='day' value="${day!''}" />
		<@inputGroupItem type='addon'>
		<@icon style='calendar' />
		<@button type='submit' name='view_manageAppointmentDesks' buttonIcon='search' title='' />
		</@inputGroupItem>

	</@inputGroup>

</@formGroup>


</@tform>

<@formGroup labelFor='day' labelKey=''>
<#list list_comments as comment>
<div class="bg-warning">
Commentaire du ${comment.startingValidityDate}: ${comment.comment!}
</div>

</#list>
<a rel='stylesheet' href='jsp/admin/plugins/appointment/ManageAppointmentSlots.jsp?view=viewAddComment&id_form=1' target="_blank" > <i class="glyphicon glyphicon-plus-sign"></i>Ajouter un commentaire</a>
</@formGroup>
</@row>
    <div class="clearfix"></div>
<@row>
    <@table>
        <tr>
            <input type="hidden" id="id" name="id"/>
	<th></th>
	<#assign x=numb_desk>
	<#assign bool="00:00" >
	<#list 1..x as seq >
            <th>Guichet: ${seq}</th>
	</#list>
            <th style="background-color:red;" >Surbooking</th>
           
        </tr>
        <@tableHeadBodySeparator />
 <#list places as place >


	<#if place.slot.startingTime != bool >		
          <tr>	
	   <td>${place.slot.startingTime}
	   </td>
         </#if>
		    <#if place.appointment ??>
			<td>
			<#if place.isSurbooking == false >
				<#if place.isOpen == true && place.slot.isOpen ==true >
				<a  href="jsp/admin/plugins/appointment/modules/desk/ManageAppointmentDesks.jsp?action=closeAppointmentDesk&id_form=${idForm}&day=${day}&numb_desk=${place.numberDesk}&start_closing=${place.slot.startingTime}&end_closing=${place.slot.endingTime}&id_slot=${place.slot.idSlot}&starting_date_time=${place.slot.startingDateTime}&ending_date_time=${place.slot.endingDateTime}&is_open=${place.slot.isOpen?c}&is_specific=${place.slot.isSpecific?c}&max_capacity=${place.slot.maxCapacity}" > <i class="fa fa-unlock" ></i>  </a>

				</#if>
				<span class="bg-warning">${place.appointment.user.lastName} ${place.appointment.user.firstName} </span>
			<#else>
			<span class="bg-warning">${place.appointment.user.lastName} ${place.appointment.user.firstName} </span>
			</#if>
			</td>
		   <#elseif place.isSurbooking == true>
			
		   <#else>
		    <td>
				
				<#if place.isOpen == true && place.slot.isOpen ==true>
				<a href="jsp/admin/plugins/appointment/modules/desk/ManageAppointmentDesks.jsp?action=closeAppointmentDesk&id_form=${idForm}&day=${day}&numb_desk=${place.numberDesk}&start_closing=${place.slot.startingTime}&end_closing=${place.slot.endingTime}&id_slot=${place.slot.idSlot}&starting_date_time=${place.slot.startingDateTime}&ending_date_time=${place.slot.endingDateTime}&is_open=${place.slot.isOpen?c}&is_specific=${place.slot.isSpecific?c}&max_capacity=${place.slot.maxCapacity}" > <i class="fa fa-unlock" ></i>  </a>
				<#elseif  place.slot.isOpen ==true>
				
				<a href="jsp/admin/plugins/appointment/modules/desk/ManageAppointmentDesks.jsp?action=openAppointmentDesk&id=${place.idAppointmentDesk}&day=${day}&id_form=${idForm}&id_slot=${place.slot.idSlot}&starting_date_time=${place.slot.startingDateTime}&ending_date_time=${place.slot.endingDateTime}&is_open=${place.slot.isOpen?c}&is_specific=${place.slot.isSpecific?c}&max_capacity=${place.slot.maxCapacity}" > <i class="glyphicon glyphicon-lock" ></i>  </a>
				</#if>
			
		    </td>
		   </#if>

	<#assign bool=place.slot.startingTime >
	<#if  place.slot.startingTime != bool>
          </tr>
	</#if>

</#list>
    
</@table>
</@row>
    <@paginationAdmin paginator=paginator />


  </@boxBody>
</@box>
<script src="js/jquery/plugins/ui/jquery-ui-1.9.2.custom.min.js"></script>
<@getDatePickerBootstrap idField="dateAppointment" language="${language}" />
<script type="text/javascript">
    $(function () {
        
        $('#day').datepicker({
        language : '${language}',
        weekStart : 1,
        todayBtn : true,
        todayHighLight : true,
        autoclose : true
    });
    });      
</script>